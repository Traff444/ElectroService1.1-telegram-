# üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è Telegram –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## –¢–µ–∫—É—â–∞—è —Å–∏—Ç—É–∞—Ü–∏—è

**–ü—Ä–æ–±–ª–µ–º–∞**: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –∫–∞–∫ 'pending' –∏ —Ç—Ä–µ–±—É—é—Ç —Ä—É—á–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏  
**–†–µ—à–µ–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤ —Ä–∞–±–æ—Ç—ã

## üîß –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (Local)

### –í–∞—Ä–∏–∞–Ω—Ç 1: –†–∞–∑–æ–≤–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
```bash
# –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ –æ–∂–∏–¥–∞—é—â–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
node process_pending_notifications.js
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥)
./auto_process_notifications.sh
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∂–∏–¥–∞—é—â–∏—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
```bash
docker exec supabase_db_ElectroService_1_-Qoder psql -U postgres -d postgres -c "
SELECT payload->>'task_title', status, created_at 
FROM edge_function_calls 
WHERE function_name = 'telegram-notifications' AND status = 'pending'
ORDER BY created_at DESC;"
```

## üöÄ –†–µ–∂–∏–º –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞ (Production)

### –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
```sql
-- –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —ç—Ç—É –∫–æ–º–∞–Ω–¥—É –≤ –ë–î:
SELECT switch_to_production_mode();
```

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –±—É–¥—É—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å—Å—è **–º–≥–Ω–æ–≤–µ–Ω–Ω–æ** –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ –∑–∞–¥–∞—á.

## üìã Workflow –ø—Ä–æ—Ü–µ—Å—Å–∞

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞:
1. –†–∞–±–æ—á–∏–π –∑–∞–≤–µ—Ä—à–∞–µ—Ç –∑–∞–¥–∞—á—É ‚úÖ
2. –¢—Ä–∏–≥–≥–µ—Ä –ª–æ–≥–∏—Ä—É–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫–∞–∫ 'pending' ‚úÖ
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ Telegram** ‚úÖ
4. –°—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –Ω–∞ 'success' ‚úÖ

### –ü—Ä–æ–¥–∞–∫—à–µ–Ω:
1. –†–∞–±–æ—á–∏–π –∑–∞–≤–µ—Ä—à–∞–µ—Ç –∑–∞–¥–∞—á—É ‚úÖ
2. –¢—Ä–∏–≥–≥–µ—Ä **–º–≥–Ω–æ–≤–µ–Ω–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ Telegram** ‚úÖ
3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ ‚úÖ

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω—ã—Ö –æ—Ç–ø—Ä–∞–≤–æ–∫
```sql
SELECT 
  payload->>'task_title' as task,
  status,
  completed_at
FROM edge_function_calls 
WHERE function_name = 'telegram-notifications'
AND status = 'success'
ORDER BY completed_at DESC
LIMIT 10;
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫
```sql
SELECT 
  payload->>'task_title' as task,
  error_message,
  created_at
FROM edge_function_calls 
WHERE function_name = 'telegram-notifications'
AND status = 'error'
ORDER BY created_at DESC;
```

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `auto_process_notifications.sh` –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
- –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç–µ—Å—å –Ω–∞ `switch_to_production_mode()`
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —á–µ—Ä–µ–∑ webhook –∏–ª–∏ –ª–æ–≥–∏
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –±—É–¥—É—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–º–∏

## ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –°–æ–∑–¥–∞–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –∑–∞–¥–∞—á—É
2. –ó–∞–≤–µ—Ä—à–∏—Ç–µ –µ—ë –∫–∞–∫ —Ä–∞–±–æ—á–∏–π
3. –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ: –∑–∞–ø—É—Å—Ç–∏—Ç–µ `node process_pending_notifications.js`
4. –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ: —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø—Ä–∏–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Telegram –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

---

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –≤ —Ä—É—á–Ω–æ–º —Ä–µ–∂–∏–º–µ (—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞), —Ç–∞–∫ –∏ –≤ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–º (–ø—Ä–æ–¥–∞–∫—à–µ–Ω)! üéâ
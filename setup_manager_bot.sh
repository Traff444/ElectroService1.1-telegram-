#!/bin/bash

# ü§ñ –ü–æ–ª–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –º–µ–Ω–µ–¥–∂–µ—Ä—Å–∫–æ–≥–æ –±–æ—Ç–∞ @ElectroServiceManagerBot
# –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –≤—Å–µ –∞—Å–ø–µ–∫—Ç—ã –±–æ—Ç–∞ –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤

MANAGER_BOT_TOKEN="8004824610:AAFJQATOO_IJc8l-6yw9ZOzHcufpHSFt4RI"
NGROK_URL="${1:-https://1f88df7a89bb.ngrok.app}"
TIMESTAMP=$(date +%s)

echo "ü§ñ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–µ–Ω–µ–¥–∂–µ—Ä—Å–∫–æ–≥–æ –±–æ—Ç–∞ @ElectroServiceManagerBot"
echo "========================================================"
echo "üîë –¢–æ–∫–µ–Ω: $MANAGER_BOT_TOKEN"
echo "üîó URL: $NGROK_URL"
echo ""

# 1. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–º—è –±–æ—Ç–∞
echo "üìõ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–º—è –±–æ—Ç–∞..."
curl -s -X POST "https://api.telegram.org/bot$MANAGER_BOT_TOKEN/setMyName" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "–≠–ª–µ–∫—Ç—Ä–æ–°–µ—Ä–≤–∏—Å - –ú–µ–Ω–µ–¥–∂–µ—Ä—Å–∫–∞—è –ø–∞–Ω–µ–ª—å"
  }'
echo " ‚úÖ"

# 2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ –±–æ—Ç–∞ (–ø–æ–ª–Ω–æ–µ)
echo "üìù –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ..."
curl -s -X POST "https://api.telegram.org/bot$MANAGER_BOT_TOKEN/setMyDescription" \
  -H "Content-Type: application/json" \
  -d '{
    "description": "üîß –≠–ª–µ–∫—Ç—Ä–æ–°–µ—Ä–≤–∏—Å - –ú–µ–Ω–µ–¥–∂–µ—Ä—Å–∫–∞—è –ø–∞–Ω–µ–ª—å\n\nüë®‚Äçüíº –î–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤ –∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä–æ–≤\nüìã –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏ –∏ –∫–æ–º–∞–Ω–¥–æ–π\nüìä –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã\nüîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç\nüì∏ –ü—Ä–æ—Å–º–æ—Ç—Ä —Ñ–æ—Ç–æ-–æ—Ç—á–µ—Ç–æ–≤\n‚úÖ –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–∏—ë–º–∫–∞ –∑–∞–¥–∞—á\n\nüöÄ –ù–∞–∂–º–∏—Ç–µ Menu ‚Üí –≠–ª–µ–∫—Ç—Ä–æ–°–µ—Ä–≤–∏—Å MANAGER\n\nüí° –î–ª—è —Å–≤—è–∑–∫–∏ –∞–∫–∫–∞—É–Ω—Ç–∞ –æ—Ç–ø—Ä–∞–≤—å—Ç–µ /start"
  }'
echo " ‚úÖ"

# 3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ—Ä–æ—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
echo "üìÑ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ—Ä–æ—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ..."
curl -s -X POST "https://api.telegram.org/bot$MANAGER_BOT_TOKEN/setMyShortDescription" \
  -H "Content-Type: application/json" \
  -d '{
    "short_description": "üîß –≠–ª–µ–∫—Ç—Ä–æ–°–µ—Ä–≤–∏—Å - –ú–µ–Ω–µ–¥–∂–µ—Ä—Å–∫–∞—è –ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏ –∏ –∫–æ–º–∞–Ω–¥–æ–π"
  }'
echo " ‚úÖ"

# 4. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞
echo "‚öôÔ∏è –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–æ–º–∞–Ω–¥—ã..."
curl -s -X POST "https://api.telegram.org/bot$MANAGER_BOT_TOKEN/setMyCommands" \
  -H "Content-Type: application/json" \
  -d '{
    "commands": [
      {
        "command": "start",
        "description": "üöÄ –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –∏ —Å–≤—è–∑–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–∞"
      },
      {
        "command": "dashboard",
        "description": "üìä –û—Ç–∫—Ä—ã—Ç—å –¥–∞—à–±–æ—Ä–¥ —Å –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π"
      },
      {
        "command": "tasks",
        "description": "üìã –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏ –∏ –ø—Ä–∏—ë–º–∫–∞ —Ä–∞–±–æ—Ç"
      },
      {
        "command": "team",
        "description": "üë• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥–æ–π —Ä–∞–±–æ—á–∏—Ö"
      },
      {
        "command": "notifications",
        "description": "üîî –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π"
      },
      {
        "command": "help",
        "description": "‚ùì –°–ø—Ä–∞–≤–∫–∞ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å–∏—Å—Ç–µ–º—ã"
      }
    ]
  }'
echo " ‚úÖ"

# 5. –û–±–Ω–æ–≤–ª—è–µ–º –º–µ–Ω—é —Å Mini App
echo "üîß –û–±–Ω–æ–≤–ª—è–µ–º –º–µ–Ω—é —Å Mini App..."
curl -s -X POST "https://api.telegram.org/bot$MANAGER_BOT_TOKEN/setChatMenuButton" \
  -H "Content-Type: application/json" \
  -d "{
    \"menu_button\": {
      \"type\": \"web_app\",
      \"text\": \"üîß –≠–ª–µ–∫—Ç—Ä–æ–°–µ—Ä–≤–∏—Å MANAGER\",
      \"web_app\": {
        \"url\": \"$NGROK_URL?manager=1&v=$TIMESTAMP\"
      }
    }
  }"
echo " ‚úÖ"

echo ""
echo "üéâ –ú–µ–Ω–µ–¥–∂–µ—Ä—Å–∫–∏–π –±–æ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—Å—Ç—Ä–æ–µ–Ω!"
echo "========================================"
echo ""
echo "ü§ñ –ë–æ—Ç: @ElectroServiceManagerBot"
echo "üì± Mini App URL: $NGROK_URL?manager=1&v=$TIMESTAMP"
echo "üîó Webhook: https://enyewzeskpiqueogmssp.functions.supabase.co/telegram-webhook"
echo ""
echo "üë®‚Äçüíº –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä–∞–º:"
echo "1. –ù–∞–π–¥–∏—Ç–µ @ElectroServiceManagerBot –≤ Telegram"
echo "2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ /start –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π"
echo "3. –°–≤—è–∂–∏—Ç–µ –≤–∞—à –∞–∫–∫–∞—É–Ω—Ç —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å"
echo "4. –ù–∞–∂–º–∏—Ç–µ Menu ‚Üí '–≠–ª–µ–∫—Ç—Ä–æ–°–µ—Ä–≤–∏—Å MANAGER'"
echo "5. –ü–æ–ª—É—á–∞–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö"
echo ""
echo "üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–∫–ª—é—á–∞—é—Ç:"
echo "‚Ä¢ –§–æ—Ç–æ-–æ—Ç—á–µ—Ç—ã –æ—Ç —Ä–∞–±–æ—á–∏—Ö"
echo "‚Ä¢ –ö–Ω–æ–ø–∫–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–∏—ë–º–∫–∏/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è"
echo "‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è —Ä–∞–±–æ—á–∏–º –æ —Ä–µ—à–µ–Ω–∏–∏"
echo ""
echo "üöÄ –ë–æ—Ç –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!"
